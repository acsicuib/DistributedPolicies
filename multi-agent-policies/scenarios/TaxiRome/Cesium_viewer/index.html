<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <!-- Include the CesiumJS JavaScript and CSS files -->
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.75/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.75/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
</head>
<body>
<div id="cesiumContainer"></div>



<script>

    Cesium.Ion.defaultAccessToken = '';

    // Initialize the Cesium Viewer in the HTML element with the `cesiumContainer` ID.
    const viewer = new Cesium.Viewer('cesiumContainer', {
        terrainProvider: Cesium.createWorldTerrain()
    });

    function mapLevel(level) {
        if (level === 0) {
            return 3000.0;
        }else if (level === 1){
            return 1200.0
        }else{
             return 600.0
        }
    }

    function mapSize(level) {
        if (level === 0) {
            return 25.0;
        }else if (level === 1){
            return 15.0
        }else{
            return 10.0
        }
    }
    function mapColor(level) {
        if (level === 0) {
            return Cesium.Color.FUCHSIA;
        }else if (level === 1){
            return Cesium.Color.GOLD;
        }else{
            return Cesium.Color.LEMONCHIFFON;
        }
    }

    const pointComara = {"longitude":12.4676473,"latitude":    41.782848}


    const points = [{'longitude': 12.4634383, 'latitude': 41.88833625, 'level': 1}, {'longitude': 12.4977863, 'latitude': 41.88833625, 'level': 1}, {'longitude': 12.4634383, 'latitude': 41.90893475, 'level': 1}, {'longitude': 12.4977863, 'latitude': 41.90893475, 'level': 1}, {'longitude': 12.4548513, 'latitude': 41.883186625, 'level': 2}, {'longitude': 12.4720253, 'latitude': 41.883186625, 'level': 2}, {'longitude': 12.4891993, 'latitude': 41.883186625, 'level': 2}, {'longitude': 12.5063733, 'latitude': 41.883186625, 'level': 2}, {'longitude': 12.4548513, 'latitude': 41.893485875, 'level': 2}, {'longitude': 12.4720253, 'latitude': 41.893485875, 'level': 2}, {'longitude': 12.4891993, 'latitude': 41.893485875, 'level': 2}, {'longitude': 12.5063733, 'latitude': 41.893485875, 'level': 2}, {'longitude': 12.4548513, 'latitude': 41.903785125, 'level': 2}, {'longitude': 12.4720253, 'latitude': 41.903785125, 'level': 2}, {'longitude': 12.4891993, 'latitude': 41.903785125, 'level': 2}, {'longitude': 12.5063733, 'latitude': 41.903785125, 'level': 2}, {'longitude': 12.4548513, 'latitude': 41.914084375, 'level': 2}, {'longitude': 12.4720253, 'latitude': 41.914084375, 'level': 2}, {'longitude': 12.4891993, 'latitude': 41.914084375, 'level': 2}, {'longitude': 12.5063733, 'latitude': 41.914084375, 'level': 2}, {'longitude': 12.4806123, 'latitude': 41.8986355, 'level': 0}]
    const edges = [{'s': 0, 't': 20}, {'s': 17, 't': 2}, {'s': 3, 't': 20}, {'s': 14, 't': 3}, {'s': 7, 't': 1}, {'s': 9, 't': 0}, {'s': 13, 't': 2}, {'s': 5, 't': 0}, {'s': 16, 't': 2}, {'s': 6, 't': 1}, {'s': 8, 't': 0}, {'s': 4, 't': 0}, {'s': 11, 't': 1}, {'s': 10, 't': 1}, {'s': 2, 't': 20}, {'s': 18, 't': 3}, {'s': 15, 't': 3}, {'s': 19, 't': 3}, {'s': 12, 't': 2}, {'s': 1, 't': 20}]
    const taxis = [{'longitude': 12.497125996713738, 'latitude': 41.91830762185444, 'code': 'taxi_122'}, {'longitude': 12.4649248836623, 'latitude': 41.8646480812845, 'code': 'taxi_260'}, {'longitude': 12.4966092132391, 'latitude': 41.910050822725786, 'code': 'taxi_351'}, {'longitude': 12.470698579827815, 'latitude': 41.88497196941139, 'code': 'taxi_197'}, {'longitude': 12.5067820009136, 'latitude': 41.9131288440065, 'code': 'taxi_58'}, {'longitude': 12.487614794424903, 'latitude': 41.8930181764688, 'code': 'taxi_297'}, {'longitude': 12.469434812665002, 'latitude': 41.8978360947222, 'code': 'taxi_352'}, {'longitude': 12.473065908828616, 'latitude': 41.900393017157654, 'code': 'taxi_317'}, {'longitude': 12.486871786455527, 'latitude': 41.92172131533307, 'code': 'taxi_188'}, {'longitude': 12.469779213474, 'latitude': 41.8922298239912, 'code': 'taxi_196'}, {'longitude': 12.488304428373402, 'latitude': 41.904491458125, 'code': 'taxi_311'}, {'longitude': 12.450720956549, 'latitude': 41.90830798440454, 'code': 'taxi_331'}, {'longitude': 12.485313070938, 'latitude': 41.8968520173803, 'code': 'taxi_361'}, {'longitude': 12.4729530904655, 'latitude': 41.8971435606299, 'code': 'taxi_105'}, {'longitude': 12.4445903461346, 'latitude': 41.8015391701924, 'code': 'taxi_89'}, {'longitude': 12.47224532836985, 'latitude': 41.89606669935061, 'code': 'taxi_295'}, {'longitude': 12.499228134809576, 'latitude': 41.91747859445333, 'code': 'taxi_172'}, {'longitude': 12.470395, 'latitude': 41.9235833333333, 'code': 'taxi_187'}, {'longitude': 12.5787443855308, 'latitude': 41.8519293432976, 'code': 'taxi_191'}, {'longitude': 12.46032143, 'latitude': 41.89981646, 'code': 'taxi_79'}, {'longitude': 12.467644947159993, 'latitude': 41.89558370293469, 'code': 'taxi_298'}, {'longitude': 12.480151117834875, 'latitude': 41.90751787016793, 'code': 'taxi_232'}, {'longitude': 12.48209321634748, 'latitude': 41.901949254124716, 'code': 'taxi_59'}, {'longitude': 12.4930847614908, 'latitude': 41.8817244261193, 'code': 'taxi_156'}, {'longitude': 12.472819532510268, 'latitude': 41.897204033490894, 'code': 'taxi_321'}, {'longitude': 12.475523166512554, 'latitude': 41.89321033683669, 'code': 'taxi_368'}, {'longitude': 12.4761338551739, 'latitude': 41.908488272666396, 'code': 'taxi_341'}, {'longitude': 12.469567134367624, 'latitude': 41.88610996368789, 'code': 'taxi_318'}, {'longitude': 12.4769209555423, 'latitude': 41.9102748745671, 'code': 'taxi_362'}, {'longitude': 12.469709361056369, 'latitude': 41.892165488080074, 'code': 'taxi_343'}, {'longitude': 12.4819011087818, 'latitude': 41.89412314040489, 'code': 'taxi_365'}, {'longitude': 12.470222454798, 'latitude': 41.8976127560957, 'code': 'taxi_234'}, {'longitude': 12.503322573765399, 'latitude': 41.88966644130271, 'code': 'taxi_53'}, {'longitude': 12.511784704856801, 'latitude': 41.933189951603104, 'code': 'taxi_135'}, {'longitude': 12.493438569927402, 'latitude': 41.856939199004, 'code': 'taxi_291'}, {'longitude': 12.507911463206598, 'latitude': 41.909039502694505, 'code': 'taxi_2'}, {'longitude': 12.464058223913801, 'latitude': 41.8997639164141, 'code': 'taxi_315'}, {'longitude': 12.4763403287228, 'latitude': 41.8435724146696, 'code': 'taxi_357'}, {'longitude': 12.472995, 'latitude': 41.900363333333296, 'code': 'taxi_61'}, {'longitude': 12.4915425437066, 'latitude': 41.921078444283104, 'code': 'taxi_257'}, {'longitude': 12.474507040669101, 'latitude': 41.8898128219691, 'code': 'taxi_174'}, {'longitude': 12.4763240002437, 'latitude': 41.8961756684404, 'code': 'taxi_281'}, {'longitude': 12.477159429196599, 'latitude': 41.918965611202296, 'code': 'taxi_178'}, {'longitude': 12.4727742184704, 'latitude': 41.897221954927204, 'code': 'taxi_228'}, {'longitude': 12.473710371014429, 'latitude': 41.896634013315726, 'code': 'taxi_37'}, {'longitude': 12.4785400687708, 'latitude': 41.8626196931107, 'code': 'taxi_132'}, {'longitude': 12.476881887377901, 'latitude': 41.8959019919821, 'code': 'taxi_248'}, {'longitude': 12.599555981745501, 'latitude': 41.860235839527505, 'code': 'taxi_259'}, {'longitude': 12.251541116712199, 'latitude': 41.784955779053, 'code': 'taxi_104'}, {'longitude': 12.45307136, 'latitude': 41.96699608, 'code': 'taxi_224'}, {'longitude': 12.4817463509252, 'latitude': 41.928371482774, 'code': 'taxi_94'}]
    const links = [{'s': 18, 't': 0}, {'s': 5, 't': 1}, {'s': 18, 't': 2}, {'s': 5, 't': 3}, {'s': 19, 't': 4}, {'s': 10, 't': 5}, {'s': 9, 't': 6}, {'s': 13, 't': 7}, {'s': 18, 't': 8}, {'s': 9, 't': 9}, {'s': 14, 't': 10}, {'s': 12, 't': 11}, {'s': 10, 't': 12}, {'s': 9, 't': 13}, {'s': 4, 't': 14}, {'s': 9, 't': 15}, {'s': 19, 't': 16}, {'s': 17, 't': 17}, {'s': 7, 't': 18}, {'s': 12, 't': 19}, {'s': 9, 't': 20}, {'s': 13, 't': 21}, {'s': 14, 't': 22}, {'s': 6, 't': 23}, {'s': 9, 't': 24}, {'s': 9, 't': 25}, {'s': 13, 't': 26}, {'s': 5, 't': 27}, {'s': 17, 't': 28}, {'s': 9, 't': 29}, {'s': 10, 't': 30}, {'s': 9, 't': 31}, {'s': 11, 't': 32}, {'s': 19, 't': 33}, {'s': 6, 't': 34}, {'s': 19, 't': 35}, {'s': 13, 't': 36}, {'s': 5, 't': 37}, {'s': 13, 't': 38}, {'s': 18, 't': 39}, {'s': 9, 't': 40}, {'s': 9, 't': 41}, {'s': 17, 't': 42}, {'s': 9, 't': 43}, {'s': 9, 't': 44}, {'s': 5, 't': 45}, {'s': 9, 't': 46}, {'s': 7, 't': 47}, {'s': 4, 't': 48}, {'s': 16, 't': 49}, {'s': 18, 't': 50}]

    //TOPOLOGY
    for (let i = 0; i < points.length; i++) {
        const dataPoint = points[i];
        // Mark this location with a red point.
        viewer.entities.add({
            description: `Loc: (${dataPoint.longitude}, ${dataPoint.latitude}, ${dataPoint.level})`,
            position: Cesium.Cartesian3.fromDegrees(dataPoint.longitude, dataPoint.latitude,
                mapLevel(dataPoint.level)),
            point: {
                pixelSize: mapSize(dataPoint.level),
                color: mapColor(dataPoint.level)
            }
        });
    }

    for (let i = 0; i < edges.length; i++) {
        nsrc = edges[i].s
        ndst = edges[i].t
        var glowingLine = viewer.entities.add({
            name: "",
            polyline: {
                positions: Cesium.Cartesian3.fromDegreesArrayHeights([
                    points[nsrc].longitude,
                    points[nsrc].latitude,
                    mapLevel(points[nsrc].level),
                    points[ndst].longitude,
                    points[ndst].latitude,
                    mapLevel(points[ndst].level)
                ]),
                width: 10,
                material: new Cesium.PolylineGlowMaterialProperty({
                    glowPower: 0.2,
                    taperPower: 0.5,
                    color: Cesium.Color.CORNFLOWERBLUE,
                }),
            },
        });
    }

    //USER TAXIS
    for (let i = 0; i < taxis.length; i++) {
        const dataPoint = taxis[i];
        // Mark this location with a red point.
        viewer.entities.add({
            description: `TAXI: (${dataPoint.longitude}, ${dataPoint.latitude}, ${dataPoint.code})`,
            position: Cesium.Cartesian3.fromDegrees(dataPoint.longitude, dataPoint.latitude,100),
            point: {
                pixelSize: 5.0,
                color: Cesium.Color.TOMATO
            }
        });
    }


    for (let i = 0; i < links.length; i++) {
        nsrc = links[i].s
        ndst = links[i].t
        var glowingLine = viewer.entities.add({
            name: "",
            polyline: {
                positions: Cesium.Cartesian3.fromDegreesArrayHeights([
                    points[nsrc].longitude,
                    points[nsrc].latitude,
                    mapLevel(points[nsrc].level),
                    taxis[ndst].longitude,
                    taxis[ndst].latitude,
                    100
                ]),
                width: 5,
                arcType: Cesium.ArcType.RHUMB,
                material: Cesium.Color.GREEN,
                // material: new Cesium.PolylineGlowMaterialProperty({
                //     glowPower: 0.2,
                //     taperPower: 0.5,
                //     color: Cesium.Color.CORNFLOWERBLUE,
                // }),
            },
        });
    }





    viewer.camera.setView({
        destination : new Cesium.Cartesian3.fromDegrees(pointComara.longitude,pointComara.latitude, 10500),
        orientation: {
            heading : Cesium.Math.toRadians(0.0),
            pitch : Cesium.Math.toRadians(-45.0)
            // roll : rollAngle
        }
    });


</script>
</div>
</body>
</html>